{{- if .Values.auth.createSecret -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.rbac.secretName }}
  labels:
    {{- include "cf-switch.labels" . | nindent 4 }}
    app.kubernetes.io/component: auth
  annotations:
    cf-switch.io/description: "API authentication token for cf-switch service"
    {{- with .Values.auth.secretAnnotations }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
type: Opaque
data:
  {{- if .Values.auth.apiToken }}
  apiToken: {{ .Values.auth.apiToken | b64enc }}
  {{- else }}
  # Empty token - will be generated by the service on first run
  apiToken: ""
  {{- end }}
{{- end }}
